# Kofftop Chat Bot

ЯП для скриптов в телеграм чате. Создан под разнообразными веществами и желанием писать скрипты для
управления чатом, прямо в самом чате. Это должно создавать атмосферу магии, волшебства и неведомых заклинаний. Правила и
ограничения языка были заложены недостатком времени и стремлением реализовать язык как можно проще. Тем не менее в
языке есть скрипты с переменными, условиями, циклами и даже функциями.

## Базовый концепт

Все операторы, инструкции и ключевые слова являются функциями. Каждая строка должна начинаться с вызова функции. Все что
идет после вызова функции, является ее аргументами. Таким образом, в каждой строке не может быть более одного вызова
функции.

## Сборка мусора

При недостатке ресурсов, долго выполняющиеся скрипты планируется принудительно убивать.

## Начало кода

Чтобы не интерпретировать все сообщения подряд, скрипты должны начинаться с `begin`, а функции с `fun`. Ошибки возникшие
при интерпретации скриптов, будут отправлены в чат. Все что начинается без этих меток, будет игнорироваться.

Пример простого скрипта который ничего не делает:

```shell
begin
```

Если вызвать `begin` далее в коде, это приведет к обнулению области видимости.

Пример пользовательской функции которая ничего не делает:

```shell
fun x y
```

Как мы видим, аргументы указываются после функции.
При отправке такого сообщения в чат, бот сохранит его на будущее как файл с кодом функции, пометив специальным
идентификатором. Это обусловлено ограничением Bot API и необходимо чтобы функцию в дальнейшем можно было вызывать из
скриптов по этому идентификатору. Если вызвать `fun` далее по коду, это приведет к запросу проверки наличия переменных в
области видимости, но не приведет к созданию новой функции.

## Преждевременный выход и возврат значения

Для этого используйте функцию `return`.

Например, рассмотрим собственную функцию, вычисляющую наибольшее число из двух:

```shell
fun x y
ifmore x y return x
ifmore y x return y
return x
```

## Переменные, типы и их литералы

Есть два типа, строки и числа. Типизация осуществляется динамически. Использование строковых и числовых литералов
запрещено везде, кроме функций `set`, `echo`. Все остальные функции могут принимать лишь переменные, но не
литералы.

Пример создания числовых и строковых переменных:

```shell
begin
set x 1
set y Hello World
set name John
```

Поскольку `set` определяет тип значения автоматически, иногда бывает удобно явно задать строку с помощью `str`

Пример:

```shell
set x 1
set y $x.5
str $y
```

Здесь по умолчанию, `y` является числом `1.5`, пока мы явно не сделаем его строкой.

Пример вывода текста с использованием предварительно заданных переменных:

```shell
begin
echo Hello $name!
```

Интерполяция строк осуществляется по правилам, аналогичным правилам Kotlin.

## Базовые функции

Так как мы не можем использовать больше одной функции в каждой строке, любая вычислительная функция первым параметром
принимает имя для новой переменной, в которую будет записано вычисленное значение. Если указать уже существующую
переменную, это значение будет перезаписано.

Пример сложения, умножения, вычитания и деления:

```shell
begin
sum x 2 2
multi x x 5
subs x 1
div x 2
echo result of op is: $x

```

Также `sum`, `multi` и `subs` могут работать со строками, складывая, повторяя или отсекая подстроку соответственно.
Если вам нужно больше математических (и других) функций, реквестуйте их в issues.

## Вызов собственных функций

Любой текстовый файл из чата может быть вызван как функция. Для этого используйте стандартную функцию `call`,
принимающую идентификатор файла и следующие за ним аргументы функции.

Пример:

```shell
begin
call 586dkgdmfkgscasdflsdllf342 2 2
```

## Условия

Условия являются специальными функциями, принимающими свои переменные, плюс следующие за ними переменные для вызова
определенной функции, в случае исполнения условия, например:

```shell
begin
set x 5
set y 6

ifmore x y call 586dkgdmfkgscasdflsdllf342 x y
```

Вы также можете использовать `ifless`, `ifeq`, `ifcontains`. Реквестуйте в issues больше условий, если вам нужно.

## Циклы

Раздел находится в разработке

## Управление чатом и функции Telegram Bot API

Раздел находится в разработке.



